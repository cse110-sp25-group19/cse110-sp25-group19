<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/js/utils.js | memory_card_game</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/cse110-sp25-group19/memory_card_game"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#js">js</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/js/utils.js~Card.html">Card</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-flipCard">flipCard</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-initGame">initGame</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-renderBoard">renderBoard</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-resetGame">resetGame</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-showEndScreen">showEndScreen</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-updateScore">updateScore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sum">sum</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-addScore">addScore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generateDeck">generateDeck</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getScore">getScore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-matchCheck">matchCheck</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-shuffleDeck">shuffleDeck</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-triggerComboEffect">triggerComboEffect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-GameState">GameState</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/js/utils.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">/**
 * Represents a single card in the memory game.
 */
class Card {
  /**
   * Creates a new Card instance.
   *
   * @param {number|string} id - Unique identifier for the card.
   * @param {*} value - Value used to determine matching pairs.
   */
  constructor(id, value) {
    /**
     * Unique identifier for the card.
     * @type {number|string}
     */
    this.id = id;

    /**
     * Value used to determine matching pairs.
     * @type {*}
     */
    this.value = value;

    /**
     * Whether the card is currently flipped face-up.
     * @type {boolean}
     */
    this.isFlipped = false;

    /**
     * Whether the card has been matched with its pair.
     * @type {boolean}
     */
    this.isMatched = false;
  }
}

/**
 * Generates a deck of matching card pairs for the memory game.
 *
 * Each pair has the same ranger type as its value. The number of pairs
 * is determined by the `pairs` parameter, defaulting to 8.
 *
 * @param {number} [pairs=8] - The number of unique pairs to include in the deck (max 8).
 * @returns {Card[]} An array containing pairs of Card objects.
 */
function generateDeck(pairs = 8) {
  const rangerTypes = [
    &apos;black-ranger&apos;,
    &apos;blue-ranger&apos;,
    &apos;green-ranger&apos;,
    &apos;pink-ranger&apos;,
    &apos;red-ranger&apos;,
    &apos;yellow-ranger&apos;,
    &apos;white-ranger&apos;,
    &apos;purple-ranger&apos;,
  ];
  const deck = [];
  let idCounter = 0;
  for (let value = 0; value &lt; pairs; value++) {
    const ranger = rangerTypes[value];
    deck.push(new Card(idCounter++, ranger));
    deck.push(new Card(idCounter++, ranger));
  }
  return deck;
}

/**
 * Shuffles the deck using the Fisher&#x2013;Yates algorithm.
 *
 * @param   {Array} deck  Array of Card objects
 * @returns {Array}       Same array reference, after shuffling
 */

function shuffleDeck(deck) {
  // TODO: Implement Fisher&#x2013;Yates
  const newDeck = [...deck];
  for (let i = newDeck.length - 1; i &gt; 0; i--) {
    let j = Math.floor(Math.random() * (i + 1));
    [newDeck[i], newDeck[j]] = [newDeck[j], newDeck[i]];
  }
  return newDeck;
}

/**
 * Deck: an array of 16 shuffled Card instances.
 */
// export const Deck = shuffleDeck(generateDeck());

/**
 * Tracks the full state of the game, including the deck, flipped cards, score, time, and current round.
 */
const GameState = {
  deck: generateDeck(),
  flippedCards: [],
  score: 0,
  round: 1,
  combo: 0,
  timeLeft: 60,
};

/**
 * Adds points to the player&apos;s score.
 *
 * @param   {number} [points=1]  How many points to add
 * @returns {number}             New total score
 */
function addScore(points = 1) {
  GameState.score += points;
  return GameState.score;
}

/**
 * Retrieves the current score.
 *
 * @returns {number}  Current score value
 */
function getScore() {
  return GameState.score;
}

/**
 * Checks if the cards in flippedCards array matches.
 *
 * @returns {bool}       True if cards match, False if cards are mismatched.
 */
function matchCheck() {
  if (GameState.flippedCards.length !== 2) return;
  let match = false;

  const [card1, card2] = GameState.flippedCards;
  if (card1.value == card2.value) {
    match = true;
    addScore();
  } else {
    setTimeout(() =&gt; {
      card1.isFlipped = false;
      card2.isFlipped = false;
    }, 1000);
  }

  GameState.flippedCards = [];
  return match;
}

/**
 * Based on the combo count, function triggers a visual effect.
 * @param {*} combo
 * @returns
 */

export function triggerComboEffect(combo) {
  const gameContainer = document.querySelector(&apos;.game-container&apos;);
  if (!gameContainer) {
    return;
  }

  gameContainer.classList.remove(&apos;combo-2&apos;, &apos;combo-3&apos;, &apos;combo-4&apos;, &apos;combo-5&apos;);
  if (combo &lt;= 4 &amp;&amp; combo &gt;= 2) {
    gameContainer.classList.add(`combo-${combo}`);
  } else if (combo &gt; 4) {
    gameContainer.classList.add(&apos;combo-5&apos;);
  }

  if (combo &gt;= 2) {
    gameContainer.classList.add(&apos;shake&apos;);
    setTimeout(() =&gt; {
      gameContainer.classList.remove(&apos;shake&apos;);
    }, 400);
  }
}

export {
  Card,
  generateDeck,
  shuffleDeck,
  GameState,
  addScore,
  getScore,
  matchCheck,
};
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
